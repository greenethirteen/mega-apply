(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[26],{1075:function(e,a,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard",function(){return l(974)}])},7094:function(e,a,l){"use strict";l.d(a,{cr:function(){return d},xI:function(){return o},yL:function(){return u}});var s=l(3977),t=l(2370),i=l(1019),n=l(6650);let c={apiKey:"AIzaSyAtjIbNpqMIPBrHuxCuvaMLf0ScqDzVgkQ",authDomain:"mega-apply.firebaseapp.com",projectId:"mega-apply",storageBucket:"mega-apply.firebasestorage.app",messagingSenderId:"149448881914",appId:"1:149448881914:web:356c06784444065cfa7b43",databaseURL:"https://mega-apply-default-rtdb.firebaseio.com"};function r(){return(0,s.C6)().length?(0,s.C6)()[0]:(0,s.ZF)(c)}function u(){let e=r();return e?(0,t.v0)(e):null}function o(){let e=r();return e?(0,i.N8)(e):null}function d(){let e=r();return e?(0,n.cF)(e):null}},974:function(e,a,l){"use strict";l.r(a),l.d(a,{default:function(){return o}});var s=l(5893),t=l(7294),i=l(2370),n=l(1019),c=l(6650),r=l(7094);let u=["Civil","Mechanical","Electrical","HSE","QAQC","Project Management","Planning","Estimation","Procurement/Logistics"];function o(){let[e,a]=(0,t.useState)(null),[l,o]=(0,t.useState)(null),[d,p]=(0,t.useState)(null),[m,h]=(0,t.useState)(null),[f,g]=(0,t.useState)({name:"",email:"",title:"",bio:"",photoUrl:"",cvUrl:"",photoPath:"",cvPath:"",categories:[],autoApplyEnabled:!1}),[v,x]=(0,t.useState)(null),[N,j]=(0,t.useState)(null),[b,y]=(0,t.useState)("");(0,t.useEffect)(()=>{let e=(0,r.yL)(),l=(0,r.xI)(),s=(0,r.cr)();if(e&&l&&s)return a(e),o(l),p(s),(0,i.Aj)(e,async e=>{if(h(e),!e)return;let a=await (0,n.U2)((0,n.iH)(l,"users/".concat(e.uid)));a.exists()?g({...f,...a.val(),email:e.email||a.val().email||""}):g(a=>({...a,email:e.email||""}))})},[]);let w=(0,t.useMemo)(()=>u,[]);async function S(e,a){if(!e||!m||!d)return"";let l=(0,c.iH)(d,a);return await (0,c.KV)(l,e),{url:await (0,c.Jt)(l),path:a}}async function A(e){if(e.preventDefault(),m&&l){y("Saving...");try{let e=f.photoUrl,a=f.cvUrl,s=f.photoPath,t=f.cvPath;if(v){let a=await S(v,"users/".concat(m.uid,"/profile.jpg"));e=a.url,s=a.path}if(N){let e=await S(N,"users/".concat(m.uid,"/cv.pdf"));a=e.url,t=e.path}let i={...f,email:m.email,photoUrl:e,cvUrl:a,photoPath:s,cvPath:t};await (0,n.t8)((0,n.iH)(l,"users/".concat(m.uid)),i),g(i),y("Saved.")}catch(e){y(e.message||"Save failed")}}}async function C(){if(!m||!l)return;if(0===f.categories.length){y("Please select up to two categories.");return}y("Auto apply enabled."),await (0,n.Vx)((0,n.iH)(l,"users/".concat(m.uid)),{categories:f.categories,autoApplyEnabled:!0,lastAutoApply:0});let e="https://us-central1-mega-apply.cloudfunctions.net";if(e)try{await fetch("".concat(e,"/runAutoApplyNow?userId=").concat(m.uid))}catch(e){}}return m?(0,s.jsxs)("div",{className:"container",children:[(0,s.jsxs)("div",{className:"header",children:[(0,s.jsxs)("div",{className:"brand",children:["MegaApply",(0,s.jsx)("span",{children:"â„¢"})," Dashboard"]}),(0,s.jsxs)("div",{className:"actions",children:[(0,s.jsx)("a",{className:"tag",href:"/",children:"Home"}),e&&(0,s.jsx)("button",{className:"btn secondary",onClick:()=>(0,i.w7)(e),children:"Sign out"})]})]}),(0,s.jsxs)("div",{className:"grid",children:[(0,s.jsx)("div",{className:"col-12",children:(0,s.jsxs)("div",{className:"card",children:[(0,s.jsx)("h2",{children:"Your profile"}),(0,s.jsxs)("form",{onSubmit:A,children:[(0,s.jsxs)("div",{className:"grid",children:[(0,s.jsxs)("div",{className:"col-6",children:[(0,s.jsx)("label",{className:"label",children:"Full Name"}),(0,s.jsx)("input",{className:"input",value:f.name,onChange:e=>g({...f,name:e.target.value})})]}),(0,s.jsxs)("div",{className:"col-6",children:[(0,s.jsx)("label",{className:"label",children:"Email"}),(0,s.jsx)("input",{className:"input",value:f.email,disabled:!0})]}),(0,s.jsxs)("div",{className:"col-6",children:[(0,s.jsx)("label",{className:"label",children:"Job Title"}),(0,s.jsx)("input",{className:"input",value:f.title,onChange:e=>g({...f,title:e.target.value})})]}),(0,s.jsxs)("div",{className:"col-6",children:[(0,s.jsx)("label",{className:"label",children:"Professional Photo"}),(0,s.jsx)("input",{className:"input",type:"file",accept:"image/*",onChange:e=>{var a;return x((null===(a=e.target.files)||void 0===a?void 0:a[0])||null)}})]}),(0,s.jsxs)("div",{className:"col-12",children:[(0,s.jsx)("label",{className:"label",children:"About you"}),(0,s.jsx)("textarea",{className:"textarea",value:f.bio,onChange:e=>g({...f,bio:e.target.value})})]}),(0,s.jsxs)("div",{className:"col-12",children:[(0,s.jsx)("label",{className:"label",children:"CV (PDF)"}),(0,s.jsx)("input",{className:"input",type:"file",accept:"application/pdf",onChange:e=>{var a;return j((null===(a=e.target.files)||void 0===a?void 0:a[0])||null)}})]})]}),(0,s.jsxs)("div",{className:"actions",style:{marginTop:16},children:[(0,s.jsx)("button",{className:"btn",type:"submit",children:"Save Profile"}),b&&(0,s.jsx)("span",{className:"tag",children:b})]})]})]})}),(0,s.jsx)("div",{className:"col-12",children:(0,s.jsxs)("div",{className:"card",children:[(0,s.jsx)("h2",{children:"Select up to 2 categories"}),(0,s.jsx)("div",{className:"actions",style:{flexWrap:"wrap"},children:w.map(e=>(0,s.jsx)("button",{type:"button",className:"tag",style:{borderColor:f.categories.includes(e)?"var(--accent)":"var(--stroke)",background:f.categories.includes(e)?"#fff3ea":"#fff"},onClick:()=>{g(a=>{let l=a.categories.includes(e)?a.categories.filter(a=>a!==e):[...a.categories,e];return l.length>2?a:{...a,categories:l}})},children:e},e))}),(0,s.jsxs)("div",{className:"actions",style:{marginTop:20},children:[(0,s.jsx)("button",{className:"btn",onClick:C,children:"Start Auto Apply"}),(0,s.jsx)("span",{className:"tag",children:f.autoApplyEnabled?"Auto apply is ON":"Auto apply is OFF"})]}),(0,s.jsx)("p",{className:"notice",children:"We will email employers your profile + CV and send you daily summaries."})]})})]})]}):(0,s.jsx)("div",{className:"container",children:(0,s.jsx)("div",{className:"card",children:"Please sign in first."})})}}},function(e){e.O(0,[627,551,25,888,774,179],function(){return e(e.s=1075)}),_N_E=e.O()}]);